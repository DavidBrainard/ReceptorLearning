<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>brainardlab.nben.retina.hyperspectral documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html">Retina 0.1.0-SNAPSHOT API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><span>Namespaces</span></h3><ul><li><a href="brainardlab.nben.retina.constants.html"><span>brainardlab.nben.retina.constants</span></a></li><li><a href="brainardlab.nben.retina.core.html"><span>brainardlab.nben.retina.core</span></a></li><li class="current"><a href="brainardlab.nben.retina.hyperspectral.html"><span>brainardlab.nben.retina.hyperspectral</span></a></li><li><a href="brainardlab.nben.retina.main.html"><span>brainardlab.nben.retina.main</span></a></li><li><a href="brainardlab.nben.retina.simulation.html"><span>brainardlab.nben.retina.simulation</span></a></li><li><a href="brainardlab.nben.retina.util.html"><span>brainardlab.nben.retina.util</span></a></li></ul></div><div class="sidebar" id="vars"><h3>Public Vars</h3><ul><li><a href="brainardlab.nben.retina.hyperspectral.html#var-*Chakrabarti2011-file-list*"><span>*Chakrabarti2011-file-list*</span></a></li><li><a href="brainardlab.nben.retina.hyperspectral.html#var-*Foster2004-file-list*"><span>*Foster2004-file-list*</span></a></li><li><a href="brainardlab.nben.retina.hyperspectral.html#var-*Parragas1998-file-list*"><span>*Parragas1998-file-list*</span></a></li><li><a href="brainardlab.nben.retina.hyperspectral.html#var-JMatIO-reader"><span>JMatIO-reader</span></a></li><li><a href="brainardlab.nben.retina.hyperspectral.html#var-autobuild-hyperspectral-cache"><span>autobuild-hyperspectral-cache</span></a></li><li><a href="brainardlab.nben.retina.hyperspectral.html#var-build-hyperspectral-cache"><span>build-hyperspectral-cache</span></a></li><li><a href="brainardlab.nben.retina.hyperspectral.html#var-calculate-hyperspectral-cache-statistics"><span>calculate-hyperspectral-cache-statistics</span></a></li><li><a href="brainardlab.nben.retina.hyperspectral.html#var-count-patches-in-cache"><span>count-patches-in-cache</span></a></li><li><a href="brainardlab.nben.retina.hyperspectral.html#var-count-patches-in-image"><span>count-patches-in-image</span></a></li><li><a href="brainardlab.nben.retina.hyperspectral.html#var-draw-patches"><span>draw-patches</span></a></li><li><a href="brainardlab.nben.retina.hyperspectral.html#var-hyperspectral-file-list"><span>hyperspectral-file-list</span></a></li><li><a href="brainardlab.nben.retina.hyperspectral.html#var-hyperspectral-image"><span>hyperspectral-image</span></a></li><li><a href="brainardlab.nben.retina.hyperspectral.html#var-hyperspectral-to-RGB"><span>hyperspectral-to-RGB</span></a></li><li><a href="brainardlab.nben.retina.hyperspectral.html#var-images-from-cache"><span>images-from-cache</span></a></li><li><a href="brainardlab.nben.retina.hyperspectral.html#var-load-JMatIO"><span>load-JMatIO</span></a></li><li><a href="brainardlab.nben.retina.hyperspectral.html#var-patch-fn-from-image"><span>patch-fn-from-image</span></a></li><li><a href="brainardlab.nben.retina.hyperspectral.html#var-push-to-cache"><span>push-to-cache</span></a></li><li><a href="brainardlab.nben.retina.hyperspectral.html#var-read-Chakrabarti2011-image"><span>read-Chakrabarti2011-image</span></a></li><li><a href="brainardlab.nben.retina.hyperspectral.html#var-read-Foster2004-image"><span>read-Foster2004-image</span></a></li><li><a href="brainardlab.nben.retina.hyperspectral.html#var-read-Parragas1998-image"><span>read-Parragas1998-image</span></a></li><li><a href="brainardlab.nben.retina.hyperspectral.html#var-read-hyperspectral-cache"><span>read-hyperspectral-cache</span></a></li><li><a href="brainardlab.nben.retina.hyperspectral.html#var-read-matlab-file"><span>read-matlab-file</span></a></li><li><a href="brainardlab.nben.retina.hyperspectral.html#var-use-png-as-hyperspectral-mask"><span>use-png-as-hyperspectral-mask</span></a></li><li><a href="brainardlab.nben.retina.hyperspectral.html#var-write-hyperspectral-as-png"><span>write-hyperspectral-as-png</span></a></li></ul></div><div class="namespace-docs" id="content"><h2>brainardlab.nben.retina.hyperspectral documentation</h2><pre class="doc"></pre><div class="public" id="var-*Chakrabarti2011-file-list*"><h3>*Chakrabarti2011-file-list*</h3><div class="usage"></div><pre class="doc">This variable lists all the files that were found in the Chakrabarti2011 database (Aug 2013)
</pre></div><div class="public" id="var-*Foster2004-file-list*"><h3>*Foster2004-file-list*</h3><div class="usage"></div><pre class="doc">This variable lists all the files that were found in the Foster2004 database (Aug 2013)
</pre></div><div class="public" id="var-*Parragas1998-file-list*"><h3>*Parragas1998-file-list*</h3><div class="usage"></div><pre class="doc">This variable lists all the files that were found in the Parragas1998 database (Aug 2013)
</pre></div><div class="public" id="var-JMatIO-reader"><h3>JMatIO-reader</h3><div class="usage"><code>(JMatIO-reader file)</code></div><pre class="doc">Yields a jmatio MatFileReader (com.jmatio.io.MatFileReader) object for the given file.  This
may throw an exception if (a) the file is not found, (b) there was a read error, ie, the file
is not a proper Matlab v5 compatible file, or (c) the jmatio library cannot be loaded.  In the
latter case, the library may be loaded dynamically using jmatio-load.  The file argument may be
a (string) filename or a File object.</pre></div><div class="public" id="var-autobuild-hyperspectral-cache"><h3>autobuild-hyperspectral-cache</h3><div class="usage"><code>(autobuild-hyperspectral-cache file &amp; {:keys [Chakrabarti2011 Foster2004 Parragas1998]})</code></div><pre class="doc">See build-hyperspectral-cache.  Give then locations of the hyperspectral image databases, builds
a hyperspectral image cache from all images.</pre></div><div class="public" id="var-build-hyperspectral-cache"><h3>build-hyperspectral-cache</h3><h4 class="macro">macro</h4><div class="usage"><code>(build-hyperspectral-cache file &amp; body)</code></div><pre class="doc">Used to build hyperspectral image caches.  The body is executed such that any call to the
push-to-cache function will insert the image into the cache.  After body has been executed, the
cache is closed and the filename returned.  On error, an exception is thrown.  The file argument
may be may be a string or a File object.</pre></div><div class="public" id="var-calculate-hyperspectral-cache-statistics"><h3>calculate-hyperspectral-cache-statistics</h3><div class="usage"><code>(calculate-hyperspectral-cache-statistics cache)</code><code>(calculate-hyperspectral-cache-statistics cache max)</code></div><pre class="doc">(calculate-hyperspectral-cache-statistics h max) yields a seq of seqs; each element of the outer
  seq is a single distance/wavelength-difference pair represented by a seq of [distance
  absolute-difference-in-wavelength correlation]. Distances out to a maximum distance of
  sqrt(2)*max are calculated (ie, a distance of max rows and max columns away).
(calculate-hyperspectral-cache-statistics h) is equivalent to
  (calculate-hyperspectral-cache-statistics h 20).</pre></div><div class="public" id="var-count-patches-in-cache"><h3>count-patches-in-cache</h3><div class="usage"><code>(count-patches-in-cache cache patch-height patch-width)</code></div><pre class="doc">Yields the total number of image caches of size patch-width by patch-height in the hyperspectral
image cache given.  The cache must be a map, as returned by read-hyperspectral-cache.</pre></div><div class="public" id="var-count-patches-in-image"><h3>count-patches-in-image</h3><div class="usage"><code>(count-patches-in-image height width patch-height patch-width)</code><code>(count-patches-in-image image patch-height patch-width)</code></div><pre class="doc">Yields the number of patches of size patch-height x patch-width in a height x width image
</pre></div><div class="public" id="var-draw-patches"><h3>draw-patches</h3><div class="usage"><code>(draw-patches cache n patch-height patch-width &amp; {:keys [random-seed]})</code></div><pre class="doc">Yields a lazy sequence of image patches drawn from the given hyperspectral cache map, which must
be created by read-hyperspectral-cache.  The seq will contain n image patches of size patch-width
by patch-height sampled randomly from the database such that the first several patches come from
the first image, the next several from the next image, etc.  The number of patches drawn from
each is based on the fraction of possible patches that can be drawn from that image.  The
optional argument :random-seed may be given to force a particular random seed.  If n is nil then
all patches are returned.</pre></div><div class="public" id="var-hyperspectral-file-list"><h3>hyperspectral-file-list</h3><div class="usage"><code>(hyperspectral-file-list &amp; {:keys [Chakrabarti2011 Foster2004 Parragas1998 strings]})</code></div><pre class="doc">Yields a list of files given the database locations.  For any database not given, those files are
not included (but an empty string &quot;&quot; or a period &quot;.&quot; may be used to indicate the current
directory).  File objects are returned in a single lazy seq; only those files that exist are
returned, unless :strings is true, in which case string objects are returned.
Note that for the Parragas1998 database, the &quot;brelstaff&quot; directory containing the image folders
is the expected argument.  For the Chakrabarti2011 database, CZ_hsdb directory is expected.  For
Foster2004, the directory containing the &quot;scene1&quot;, &quot;scene2&quot; etc. directories is expected.</pre></div><div class="public" id="var-hyperspectral-image"><h3>hyperspectral-image</h3><div class="usage"><code>(hyperspectral-image image-fn [rows cols] &amp; {:keys [filter wavelengths]})</code></div><pre class="doc">Yields a hyperspectral-image structure given the hyperspectral image data specified in the
options.  This hyperspectral-image structure can be understood by push-to-cache and
build-hyperspectral-cache.  The arguments to this function must be as follows:
image-fn must be a function that, given two integers, returns the pixel (a seq of numbers) at
 those coordinates
size must be the [rows cols] of the image
:filter may be a sequence of either masks indicating which bits should be excluded (all cells
 set to nil, false, or 0 will be excluded), rectangular regions to be excluded, specified
 by [[row-ul col-ul] [row-lr col-lr]] where ul and lr stand for upper-left and lower-right, or a
 function that takes a row and col as arguments and returns true for any pixel to be included.
:wavelengths is by default equivalent to (range 400 721 10) and specifies the wavelengths on
 which the image is sampled.</pre></div><div class="public" id="var-hyperspectral-to-RGB"><h3>hyperspectral-to-RGB</h3><div class="usage"><code>(hyperspectral-to-RGB hsimage)</code></div><pre class="doc">Yields an BufferedImage object containing the RGB matrix converted from the given hyperspectral
image.  This function uses CIE-xyz1931-matrix for conversion, which was originally obtained from
the psychtoolbox.</pre></div><div class="public" id="var-images-from-cache"><h3>images-from-cache</h3><div class="usage"><code>(images-from-cache cache &amp; {:keys [delay]})</code></div><pre class="doc">Yields a lazy seq of the hyperspectral images in the cache (read by read-hyperspectral-cache).
An optional :delay may be set to true if delay objects are prefered (ie, if not all images will
be used, then the unused images will not be loaded).</pre></div><div class="public" id="var-load-JMatIO"><h3>load-JMatIO</h3><div class="usage"><code>(load-JMatIO path)</code></div><pre class="doc">Loads the JMatIO class and returns true if successful.  This function throws exceptions on
error due to not wrapping a try statement around the ClassLoader and Class.forName calls.
The path argument may be a File, String, or URL.  If the path is a string, it is assumed to be
a file unless it begins with &quot;http://&quot;.  If the JMatIO library is already loaded, this
returns nil.</pre></div><div class="public" id="var-patch-fn-from-image"><h3>patch-fn-from-image</h3><div class="usage"><code>(patch-fn-from-image image patch-height patch-width)</code></div><pre class="doc">Yields a function that, given an index i, yields the ith image patch of size patch-height x
patch-width from the given image.  The index i should begin at 0.  The image should be either
an HSImage instance or a data structure that can handle nth.</pre></div><div class="public" id="var-push-to-cache"><h3>push-to-cache</h3><div class="usage"><code>(push-to-cache hs-image)</code></div><pre class="doc">Pushes the given image, absent all exclusions, to the open hyperspectral cache.  This function
can be called only from within a build-hyperspectral-cache form.  Exclusions may be specified as
matrices of booleans (or numbers where 0/false/nil are taken to be included), or as seqs of
rectangles specified as [[row-ul col-ul] [row-lr col-lr]] where ul and lr indicate upper left and
lower right, respectively (rectangles are assumed to be inclusive).</pre></div><div class="public" id="var-read-Chakrabarti2011-image"><h3>read-Chakrabarti2011-image</h3><div class="usage"><code>(read-Chakrabarti2011-image file &amp; {:keys [filter-lbl filter calib], :or {filter-lbl true}})</code></div><pre class="doc">Yields the hyperspectral image structure for the hyperspectral image specified by file. File may
be a string or a File object.  If errors are encountered, exceptions are thrown.  All given
filters are included in the hyperspectral image definition, along with the exclusions included
in the Chakrabarti2011 matlab file.  If you do not wish to exclude the lbl field of the matlab
file, then the option :filter-lbl should be false.  The contents of the calib.txt file can also
be passed in the :calib argument; otherwise it is loaded automatically.</pre></div><div class="public" id="var-read-Foster2004-image"><h3>read-Foster2004-image</h3><div class="usage"><code>(read-Foster2004-image file &amp; {:keys [filter]})</code></div><pre class="doc">Yields the hyperspectral image structure for the hyperspectral image specified by file. File may
be a string or a File object.  If errors are encountered, exceptions are thrown.  All given
filters are included in the hyperspectral image definition.</pre></div><div class="public" id="var-read-Parragas1998-image"><h3>read-Parragas1998-image</h3><div class="usage"><code>(read-Parragas1998-image directory &amp; {:keys [filter]})</code></div><pre class="doc">Yields the hyperspectral image structure for the hyperspectral image specified by directory. The
directory argument may be a string or a File object.  If errors are encountered, exceptions are
thrown.  All given filters are included in the hyperspectral image definition.</pre></div><div class="public" id="var-read-hyperspectral-cache"><h3>read-hyperspectral-cache</h3><div class="usage"><code>(read-hyperspectral-cache file)</code></div><pre class="doc">Opens the given file (either a File objerct or a filename) and reads in each hyperspectral image
in the cache sequentially and lazilly.  Note that in order to ensure that the file is closed,
the sequence must be entirely evaluated or the .close method must be called on the :stream field
of the returned map.  The returned map contains three fields: :stream (the file), :index (the
sizes of all images contained in this cache), and :images (the lazy sequence of images).</pre></div><div class="public" id="var-read-matlab-file"><h3>read-matlab-file</h3><div class="usage"><code>(read-matlab-file file)</code></div><pre class="doc">Yields a map of variable name to the MLArray object saved to that name in the given MAT file.
The given file may be either a File object or a string.  If JMatIO is not loaded, an exception
will be thrown.</pre></div><div class="public" id="var-use-png-as-hyperspectral-mask"><h3>use-png-as-hyperspectral-mask</h3><div class="usage"><code>(use-png-as-hyperspectral-mask hsimage png-file &amp; {:keys [exclude-color wavelengths], :or {exclude-color 0}})</code></div><pre class="doc">Given a hyerspectral image and the filename, file object, or BufferedImage object for a PNG file,
uses the png file as a mask, where the :exclude-color option (default 0/black) is used as a clue
that the hyperspectral pixel will be excluded, and yields a version of hsimage that is suitable
for use with push-to-cache with the proper exclusions. Note that the images must be the same size
or an error is thrown.</pre></div><div class="public" id="var-write-hyperspectral-as-png"><h3>write-hyperspectral-as-png</h3><div class="usage"><code>(write-hyperspectral-as-png file hsimage)</code></div><pre class="doc">Writes a .png file to the given file location by converting the given hyperspectral image to
an RGB image using hyperspectral-to-RGB.  Yields the java.io.File object if successful and nil
otherwise.</pre></div></div></body></html>